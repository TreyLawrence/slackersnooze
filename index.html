<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Slackersnooze : Hacker News: Personalized">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Slackersnooze</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/TreyLawrence/slackersnooze">View on GitHub</a>

          <h1 id="project_title">Slackersnooze</h1>
          <h2 id="project_tagline">Hacker News: Personalized</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/TreyLawrence/slackersnooze/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/TreyLawrence/slackersnooze/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h3>
<a id="welcome-to-slacker-snooze" class="anchor" href="#welcome-to-slacker-snooze" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Welcome to <a href="http://slackersnooze.com">Slacker Snooze</a>.</h3>

<p><a href="http://slackersnooze.com">Slacker snooze</a> is a clone of <a href="https://news.ycombinator.com">hacker news</a>, a popular news article aggregator for hacker-types. I enjoy occasionally browsing the posts on this site, but find myself only interested in a small subset of them. I wanted to save time I spend on the site by having an easier way to surface posts that actually interest me, so that's why I wanted to build a recommendation system for it. At the same time, I wanted to implement it with technologies that I hadn't really used before as a learning opportunity: python3, numpy/scipy, and <a href="http://nlp.stanford.edu/projects/glove/">GloVe</a> word vectors. I wanted to keep the idea relatively simple to implement:</p>

<ul>
<li>Reuse the design and layout of the existing site, and only reimplement the sorting algorithm of top stories</li>
<li>Track users by a cookie instead of requiring them to login</li>
<li>Recommend posts from their headlines using the history of posts a user has clicked on</li>
</ul>

<p>In order to recommend by the headline, I needed some way of conceptually representing each word in a headline, which is why I chose to work with the GloVe vectors. However, some words are more important than others (eg: "docker" vs. "the"), so I wanted to weight these vectors by their <a href="https://en.wikipedia.org/wiki/Tf%E2%80%93idf">tf-idf</a> score. Thus, to vectorize the entire headline, I just sum each word vector in the headline, weighted by its tf-idf score.</p>

<h3>
<a id="inserting-glove-vectors" class="anchor" href="#inserting-glove-vectors" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Inserting GloVe vectors</h3>

<p>I used the cased Common Crawl dataset, which provides 2.2 million words. This is a 5.5G file, so loading this into memory every time is prohibitively expensive. Instead, I inserted them into postgres, where each row is the word and its 300 dimensional vector stored as a postgres array.</p>

<h3>
<a id="polling-the-hn-api" class="anchor" href="#polling-the-hn-api" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Polling the HN API</h3>

<p>In order to keep up-to-date with the current articles, I'm polling the HN API for the top 500 articles every 5 minutes, and then getting their metadata (posting user, number of comments, number of points, id, title, date posted, and article url), and upserting into Postgres, updating the number of comments and its score if it's already been inserted. In addition to keeping the current articles up-to-date, we also want to update the frequency in which words appear, so our tf-idf scores will update over time. Each unique word per headline is then incremented by one.</p>

<h3>
<a id="copying-design" class="anchor" href="#copying-design" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Copying design</h3>

<p>In order to make it look similar to hacker news, I am re-using the same CSS file and images. Since I'm only reimplementing the sorting of the top articles, I can get away with using the majority of the same HTML, but need to template out the HTML for each headline, so I can display the title along with its metadata. For templating, I'm using python's jinja2 library.</p>

<h3>
<a id="tracking-users-clicks" class="anchor" href="#tracking-users-clicks" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Tracking users' clicks</h3>

<p>A user can click an article's headline link or comments link, both we can use as an indication that the user is interested in that article's topic. However, to track these clicks, I added two redirect endpoints that will first write to the database a user's click, and then redirect to either the article's link or its comments section, depending on which was clicked.</p>

<h3>
<a id="re-sorting-top-articles" class="anchor" href="#re-sorting-top-articles" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Re-sorting top articles</h3>

<p>This is the part that's fun. When a new user arrives at slackersnooze, we give them a new cookie. Since that user hasn't clicked on any articles yet, we give a default sort based on the popularity of an article, or number of points HN users have given it.</p>

<p>After a user has clicked on their first article, we then re-sort based on distance between an article's vector and the combination of articles a user has clicked on. At first, I was just averaging each clicked article's vector together, but this started to break down when a user had diverse interests (ie: large variance). I was introduced to <a href="https://en.wikipedia.org/wiki/Mahalanobis_distance">Mahalanobis distance</a> by a fellow RC'er, and quickly found that scipy has an <a href="https://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.spatial.distance.mahalanobis.html">implementation</a> that will magically do it for me.</p>

<h3>
<a id="deploying" class="anchor" href="#deploying" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Deploying</h3>

<p>Because AWS is cheap(ish), I decided to deploy this with elastic beanstalk and docker. There's a postgres RDS instance, autoscaling group, and load balancer that all come for free, which is nice. I purchased the domain from namecheap, and used route53 to hook it up.</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Slackersnooze maintained by <a href="https://github.com/TreyLawrence">TreyLawrence</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
